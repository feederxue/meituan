<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" href="./scss/style.css">
    <link rel="stylesheet" href="./fonts/iconfont.css">
    <link rel="stylesheet" href="./swiper4/swiper-4.3.5.min.css">
    <script src="./js/flexible.js"></script>
    <script src="./swiper4/swiper-4.3.5.min.js"></script>
    <script src="./js/better-scroll.js"></script>
</head>

<body>
    <div class="wrap">
        <div class="br">
            <div class="up">下拉刷新</div>
            <header>
                <p>北京^</p>
                <p>
                    <i class="icon iconfont icon-fangdajing"></i>
                    <input type="text" value="输入商家/品类/商圈">
                </p>
                <p>
                    <i class="icon iconfont icon-yonghu"></i>
                    <span>我的</span>
                </p>
            </header>
            <section>
                <div class="img">
                    <img src="./img/1.png" alt="">
                </div>
                <div class="swiper-container boss">
                    <ul class="swiper-wrapper">
                        <li class="swiper-slide">
                            <dl>
                                <dd><img src="./img/2.png" alt=""></dd>
                                <dt>美食</dt>
                            </dl>
                            <dl>
                                <dd><img src="./img/2.png" alt=""></dd>
                                <dt>美食</dt>
                            </dl>
                            <dl>
                                <dd><img src="./img/2.png" alt=""></dd>
                                <dt>美食</dt>
                            </dl>
                            <dl>
                                <dd><img src="./img/2.png" alt=""></dd>
                                <dt>美食</dt>
                            </dl>
                            <dl>
                                <dd><img src="./img/2.png" alt=""></dd>
                                <dt>美食</dt>
                            </dl>
                            <dl>
                                <dd><img src="./img/2.png" alt=""></dd>
                                <dt>美食</dt>
                            </dl>
                            <dl>
                                <dd><img src="./img/2.png" alt=""></dd>
                                <dt>美食</dt>
                            </dl>
                            <dl>
                                <dd><img src="./img/2.png" alt=""></dd>
                                <dt>美食</dt>
                            </dl>
                            <dl>
                                <dd><img src="./img/2.png" alt=""></dd>
                                <dt>美食</dt>
                            </dl>
                            <dl>
                                <dd><img src="./img/2.png" alt=""></dd>
                                <dt>美食</dt>
                            </dl>
                        </li>
                        <li class="swiper-slide">
                            <dl>
                                <dd><img src="./img/3.png" alt=""></dd>
                                <dt>猫眼电影</dt>
                            </dl>
                            <dl>
                                <dd><img src="./img/3.png" alt=""></dd>
                                <dt>猫眼电影</dt>
                            </dl>
                            <dl>
                                <dd><img src="./img/3.png" alt=""></dd>
                                <dt>猫眼电影</dt>
                            </dl>
                            <dl>
                                <dd><img src="./img/3.png" alt=""></dd>
                                <dt>猫眼电影</dt>
                            </dl>
                            <dl>
                                <dd><img src="./img/3.png" alt=""></dd>
                                <dt>猫眼电影</dt>
                            </dl>
                            <dl>
                                <dd><img src="./img/3.png" alt=""></dd>
                                <dt>猫眼电影</dt>
                            </dl>
                            <dl>
                                <dd><img src="./img/3.png" alt=""></dd>
                                <dt>猫眼电影</dt>
                            </dl>
                            <dl>
                                <dd><img src="./img/3.png" alt=""></dd>
                                <dt>猫眼电影</dt>
                            </dl>
                            <dl>
                                <dd><img src="./img/3.png" alt=""></dd>
                                <dt>猫眼电影</dt>
                            </dl>
                            <dl>
                                <dd><img src="./img/3.png" alt=""></dd>
                                <dt>猫眼电影</dt>
                            </dl>
                        </li>
                    </ul>
                    <div class="swiper-pagination"></div>
                </div>
                <div class="h1"></div>
                <div class="content">
                    <div class="txt">猜你喜欢</div>
                    <div class="con">
                        <!-- <dl>
                            <dd><img src="./img/4.jpg" alt=""></dd>
                            <dt>
                            <p>全聚德</p>
                            <p>[东城区]精品烤鸭3-4人餐1份</p>
                            <div class="base">
                                <p><span>398</span>元门市价：498元</p>
                                <p>已售3305</p>
                            </div>
                        </dt>
                        </dl>
                        <dl>
                            <dd><img src="./img/4.jpg" alt=""></dd>
                            <dt>
                                <p>全聚德</p>
                                <p>[东城区]精品烤鸭3-4人餐1份</p>
                                <div class="base">
                                    <p><span>398</span>元门市价：498元</p>
                                    <p>已售3305</p>
                                </div>
                            </dt>
                        </dl> -->
                    </div>
                </div>
                <footer>
                    <div class="f1">
                        <p>
                            <span>登录</span>
                            <span>注册</span>
                        </p>
                        <li>
                            城市：<span>北京</span>
                        </li>
                    </div>
                    <div class="f2">
                        <span>首页</span>
                        <span>我的</span>
                        <span>美团下载</span>
                        <span>电脑版</span>
                        <span>帮助</span>
                    </div>
                    <div class="f3">
                        <span>友情链接：</span>
                        <a>猫眼电影</a>
                        <a>大众点评</a>
                        <a>美团旅游</a>
                        <a>糖果名宿</a>
                        <a>大众点评下载</a>
                        <a>美团收银官网</a>
                        <a>美团点评餐饮学院</a>
                        <a>快驴进货商家合作</a>
                    </div>
                    <p>——————————————————————</p>
                </footer>
            </section>
            <div class="down">上拉加载</div>
        </div>
    </div>
    <script src="./js/ajax.js"></script>
    <script src="./js/zepto.js"></script>
    <script>
        var swiper = new Swiper('.boss', {
            pagination: {
                el: '.swiper-pagination'
            }
        })

        var bscroll = new BScroll('.wrap', {
            probeType: 2,
            scrollbar: true
        })

        var page = 1;
        var newData;
        ajax({
            url: './data/data.json',
            data: {
                page: page
            },
            success: function(data) {
                newData = data;
                render(data);
            }
        })

        function render(data) {
            $.each(data, function(i, t) {
                var html = '';
                html += ` <dl>
                                <dd><img src="${t.img}" alt=""></dd>
                                <dt>
                                <p>${t.name}</p>
                                <p>${t.address}</p>
                                <div class="base">
                                    <p><span class="price">${t.price}</span>元门市价：498元</p>
                                    <p>已售3305</p>
                                </div>
                            </dt>
                            </dl>`;
                $('.con').append(html);
            })
        }
        bscroll.on('scroll', function() {
            if (this.y < this.maxScrollY - 40) {
                $('.down').html('释放加载更多').addClass('file')
            } else if (this.y < this.maxScrollY - 20) {
                $('.down').html('上拉加载').removeClass('file')
            } else if (this.y > 40) {
                $('.up').html('释放刷新').addClass('file')
            } else if (this.y > 20) {
                $('.up').html('下拉刷新').removeClass('file')
            }
        });
        bscroll.on('scrollEnd', function() {
            if ($('.down').hasClass('file')) {
                up();
                $('.down').html('上拉加载').removeClass('file')
            } else if ($('.up').hasClass('file')) {
                down();
                $('.up').html('下拉刷新').removeClass('file')
            }
        })

        function up() {
            page++;
            render(newData);
        }

        function down() {
            $('.con').html('');
            page = 1;
            render(newData);
        }
    </script>
</body>

</html>